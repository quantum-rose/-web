{"version":3,"sources":["script.js"],"names":["$cvs","document","querySelector","cvsCtx","getContext","intRandom","start","end","Object","prototype","toString","call","TypeError","Math","floor","round","random","w","width","offsetWidth","window","devicePixelRatio","h","height","offsetHeight","fontSize","textOffset","stripeOffset","cutLine","addEventListener","createCutLine","i","push","length","sort","a","b","drawNoise","imageData","createImageData","data","putImageData","drawText","fillStyle","fillRect","font","textAlign","textBaseline","save","beginPath","rect","clip","fillText","restore","drawStripe","f","createLinearGradient","addColorStop","lastTime","r","requestAnimationFrame","draw","Date","now","clearRect"],"mappings":"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","sourcesContent":["const $cvs = document.querySelector('#cvs');\r\nconst cvsCtx = $cvs.getContext('2d');\r\n\r\n/**\r\n * 生成一个介于 start 和 end 之间的整数，闭区间\r\n */\r\nfunction intRandom(start, end) {\r\n    if (Object.prototype.toString.call(start) !== '[object Number]') throw new TypeError(`${start} is not a number`);\r\n    if (Object.prototype.toString.call(end) !== '[object Number]') throw new TypeError(`${end} is not a number`);\r\n    start = Math.floor(start);\r\n    end = Math.floor(end) + 1;\r\n    return Math.round(Math.random() * (end - start) + start);\r\n}\r\n\r\nlet w = ($cvs.width = $cvs.offsetWidth * window.devicePixelRatio);\r\nlet h = ($cvs.height = $cvs.offsetHeight * window.devicePixelRatio);\r\nlet fontSize = w / 4;\r\nlet textOffset = w / 100;\r\nlet stripeOffset = 0;\r\nlet cutLine;\r\n\r\nwindow.addEventListener('resize', function () {\r\n    w = $cvs.width = $cvs.offsetWidth * window.devicePixelRatio;\r\n    h = $cvs.height = $cvs.offsetHeight * window.devicePixelRatio;\r\n    fontSize = w / 4;\r\n    textOffset = w / 100;\r\n});\r\n\r\nfunction createCutLine() {\r\n    cutLine = [0, h];\r\n    for (let i = 0; i < 6; i++) {\r\n        cutLine.push(intRandom(cutLine[0], cutLine[cutLine.length - 1]));\r\n    }\r\n    cutLine.sort((a, b) => a - b);\r\n}\r\n\r\nfunction drawNoise() {\r\n    const imageData = cvsCtx.createImageData(w, h);\r\n    const data = imageData.data;\r\n    for (let i = 0; i < data.length; i += 4) {\r\n        data[i] = data[i + 1] = data[i + 2] = intRandom(0, 255);\r\n        data[i + 3] = 255;\r\n    }\r\n    cvsCtx.putImageData(imageData, 0, 0);\r\n}\r\n\r\nfunction drawText() {\r\n    cvsCtx.fillStyle = '#000000';\r\n    cvsCtx.fillRect(0, 0, w, h);\r\n\r\n    cvsCtx.fillStyle = '#ffffff';\r\n    cvsCtx.font = `bold ${fontSize}px Helvetica`;\r\n    cvsCtx.textAlign = 'center';\r\n    cvsCtx.textBaseline = 'middle';\r\n\r\n    createCutLine();\r\n    for (let i = 0; i < cutLine.length - 1; i++) {\r\n        cvsCtx.save();\r\n        cvsCtx.beginPath();\r\n        cvsCtx.rect(0, cutLine[i], w, cutLine[i + 1] - cutLine[i]);\r\n        cvsCtx.clip();\r\n        cvsCtx.fillText('NOISE', w / 2 + intRandom(-textOffset, textOffset), h / 2);\r\n        cvsCtx.restore();\r\n    }\r\n}\r\n\r\nfunction drawStripe() {\r\n    cvsCtx.beginPath();\r\n    const f = cvsCtx.createLinearGradient(0, -stripeOffset, 0, 2 * h - stripeOffset);\r\n    for (let i = 0; i < 256; i += 2) {\r\n        f.addColorStop(i / 256, 'rgba(255, 255, 255, 0.1)');\r\n        f.addColorStop((i + 1) / 256, 'rgba(255, 255, 255, 0)');\r\n    }\r\n    cvsCtx.fillStyle = f;\r\n    cvsCtx.fillRect(0, 0, w, h);\r\n    stripeOffset = (stripeOffset + h / 256) % h;\r\n}\r\n\r\nlet lastTime = 0;\r\nlet r = intRandom(1, 3);\r\nrequestAnimationFrame(function draw() {\r\n    if (Date.now() - lastTime > 40) {\r\n        lastTime = Date.now();\r\n        cvsCtx.clearRect(0, 0, w, h);\r\n        if (Math.floor(lastTime / r / 1000) % 2 === 0) {\r\n            r = intRandom(1, 3);\r\n            drawNoise();\r\n        } else {\r\n            drawText();\r\n        }\r\n        drawStripe();\r\n    }\r\n    requestAnimationFrame(draw);\r\n});\r\n"],"file":"script.babel.js"}