{"version":3,"sources":["script.js"],"names":["data","per","fill","$pieConicGradient","document","querySelector","$pieSvgPath","$pieSvgDash","$pieCanvas","PieConicGradient","elem","style","borderRadius","backgroundColor","_render","gradientArr","θ","forEach","item","push","backgroundImage","join","pieConicGradient","PieSvgPath","setAttribute","innerHTML","Math","PI","x","y","pie","θper","endX","endY","pies","length","i","createElementNS","appendChild","cos","sin","pieSvgPath","PieSvgDash","C","lengthPer","pieSvgDash","PieCanvas","cvsCtx","getContext","width","height","offsetWidth","window","devicePixelRatio","addEventListener","halfCvsSize","clearRect","beginPath","fillStyle","arc","moveTo","closePath","pieCanvas","$playPause","lastTime","percent","requestAnimationFrame","update","Date","now","checked"],"mappings":"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","sourcesContent":["const data = [\r\n        {\r\n            per: 30 / 360,\r\n            fill: '#37c',\r\n        },\r\n        {\r\n            per: 35 / 360,\r\n            fill: '#3c7',\r\n        },\r\n        {\r\n            per: 45 / 360,\r\n            fill: 'orange',\r\n        },\r\n        {\r\n            per: 90 / 360,\r\n            fill: '#f73',\r\n        },\r\n    ],\r\n    $pieConicGradient = document.querySelector('.pie-conic-gradient'),\r\n    $pieSvgPath = document.querySelector('.pie-svg-path'),\r\n    $pieSvgDash = document.querySelector('.pie-svg-dash'),\r\n    $pieCanvas = document.querySelector('.pie-canvas');\r\n\r\nclass PieConicGradient {\r\n    elem = null;\r\n    data = [];\r\n    constructor(elem, data) {\r\n        this.elem = elem;\r\n        this.data = data;\r\n        this.elem.style.borderRadius = '50%';\r\n        this.elem.style.backgroundColor = '#ccc';\r\n        this._render();\r\n    }\r\n    _render() {\r\n        let gradientArr = [],\r\n            θ = 0; // 饼图起始位置，圆锥渐变 top 方向为 0deg，right 方向为 90deg\r\n        this.data.forEach(item => {\r\n            gradientArr.push(`${item.fill} ${θ}deg, ${item.fill} ${(θ += 360 * item.per)}deg`);\r\n        });\r\n        this.elem.style.backgroundImage = `conic-gradient(${gradientArr.join(',')}, rgba(0, 0, 0, 0) ${θ}deg)`;\r\n    }\r\n    update(data) {\r\n        this.data = data;\r\n        this._render();\r\n    }\r\n}\r\nconst pieConicGradient = new PieConicGradient($pieConicGradient, data);\r\n\r\nclass PieSvgPath {\r\n    elem = null;\r\n    data = [];\r\n    pies = [];\r\n    constructor(elem, data) {\r\n        this.elem = elem;\r\n        this.data = data;\r\n        this.elem.setAttribute('viewBox', '0 0 100 100');\r\n        this.elem.innerHTML = `<circle cx=\"50\" cy=\"50\" r=\"50\" fill=\"#ccc\" />`;\r\n        this._render();\r\n    }\r\n    _render() {\r\n        let θ = -Math.PI / 2, // 饼图起始位置，x 轴正方向为 0，y 轴正方向为 π/2\r\n            x = 50,\r\n            y = 0,\r\n            pie = null,\r\n            θper = 0,\r\n            endX = 0,\r\n            endY = 0;\r\n        this.pies.length = this.data.length;\r\n        this.data.forEach((item, i) => {\r\n            if (!this.pies[i]) {\r\n                this.pies[i] = document.createElementNS('http://www.w3.org/2000/svg', 'path');\r\n                this.elem.appendChild(this.pies[i]);\r\n            }\r\n            θ += Math.PI * 2 * item.per;\r\n            θper = Math.PI * 2 * item.per;\r\n            endX = Math.cos(θ) * 50 + 50;\r\n            endY = Math.sin(θ) * 50 + 50;\r\n            pie = this.pies[i];\r\n            pie.setAttribute('d', `M 50 50 L ${x} ${y} A 50 50 0 ${θper > Math.PI ? 1 : 0} 1 ${endX} ${endY} Z`);\r\n            pie.setAttribute('fill', item.fill);\r\n            x = endX;\r\n            y = endY;\r\n        });\r\n    }\r\n    update(data) {\r\n        this.data = data;\r\n        this._render();\r\n    }\r\n}\r\nconst pieSvgPath = new PieSvgPath($pieSvgPath, data);\r\n\r\nclass PieSvgDash {\r\n    elem = null;\r\n    data = [];\r\n    pies = [];\r\n    constructor(elem, data) {\r\n        this.elem = elem;\r\n        this.data = data;\r\n        this.elem.setAttribute('viewBox', '0 0 100 100');\r\n        this.elem.innerHTML = `<circle cx=\"50\" cy=\"50\" r=\"25\" stroke-width=\"50\" stroke=\"#ccc\" />`;\r\n        this._render();\r\n    }\r\n    _render() {\r\n        let C = Math.PI * 2 * 25,\r\n            length = 0,\r\n            lengthPer = 0,\r\n            pie = null;\r\n        this.pies.length = this.data.length;\r\n        this.data.forEach((item, i) => {\r\n            if (!this.pies[i]) {\r\n                this.pies[i] = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\r\n                this.elem.appendChild(this.pies[i]);\r\n            }\r\n            lengthPer = C * item.per;\r\n            pie = this.pies[i];\r\n            pie.setAttribute('cx', 50);\r\n            pie.setAttribute('cy', 50);\r\n            pie.setAttribute('r', 25);\r\n            pie.setAttribute('stroke', item.fill);\r\n            pie.setAttribute('stroke-width', 50);\r\n            pie.setAttribute('stroke-dasharray', `0 ${length} ${lengthPer} ${C}`);\r\n            pie.setAttribute('fill-opacity', 0);\r\n            pie.setAttribute('transform', 'rotate(-90, 50, 50)');\r\n            length += lengthPer;\r\n        });\r\n    }\r\n    update(data) {\r\n        this.data = data;\r\n        this._render();\r\n    }\r\n}\r\nconst pieSvgDash = new PieSvgDash($pieSvgDash, data);\r\n\r\nclass PieCanvas {\r\n    elem = null;\r\n    cvsCtx = null;\r\n    data = [];\r\n    constructor(elem, data) {\r\n        this.elem = elem;\r\n        this.cvsCtx = this.elem.getContext('2d');\r\n        this.data = data;\r\n        this.elem.width = this.elem.height = this.elem.offsetWidth * window.devicePixelRatio;\r\n        this._render();\r\n        window.addEventListener('resize', () => {\r\n            this.elem.width = this.elem.height = this.elem.offsetWidth * window.devicePixelRatio;\r\n            this._render();\r\n        });\r\n    }\r\n    _render() {\r\n        let cvsCtx = this.cvsCtx,\r\n            halfCvsSize = this.elem.width / 2,\r\n            θ = -Math.PI / 2; // 饼图起始位置，x 轴正方向为 0，y 轴正方向为 π/2\r\n        cvsCtx.clearRect(0, 0, this.elem.width, this.elem.height);\r\n        cvsCtx.beginPath();\r\n        cvsCtx.fillStyle = '#ccc';\r\n        cvsCtx.arc(halfCvsSize, halfCvsSize, halfCvsSize, 0, Math.PI * 2, false);\r\n        cvsCtx.fill();\r\n        this.data.forEach(item => {\r\n            cvsCtx.beginPath();\r\n            cvsCtx.fillStyle = item.fill;\r\n            cvsCtx.moveTo(halfCvsSize, halfCvsSize);\r\n            cvsCtx.arc(halfCvsSize, halfCvsSize, halfCvsSize, θ, (θ += Math.PI * 2 * item.per), false);\r\n            cvsCtx.closePath();\r\n            cvsCtx.fill();\r\n        });\r\n    }\r\n    update(data) {\r\n        this.data = data;\r\n        this._render();\r\n    }\r\n}\r\nconst pieCanvas = new PieCanvas($pieCanvas, data);\r\n\r\n(function () {\r\n    let $playPause = document.querySelector('#play-pause'),\r\n        lastTime = 0,\r\n        percent = 0;\r\n    requestAnimationFrame(function update() {\r\n        if (Date.now() - lastTime > 16 && $playPause.checked) {\r\n            lastTime = Date.now();\r\n            percent = (percent + 0.005) % 1;\r\n            data[0].per = (20 / 360) * percent;\r\n            data[1].per = (50 / 360) * percent;\r\n            data[2].per = (100 / 360) * percent;\r\n            data[3].per = (190 / 360) * percent;\r\n            pieConicGradient.update(data);\r\n            pieSvgPath.update(data);\r\n            pieSvgDash.update(data);\r\n            pieCanvas.update(data);\r\n        }\r\n        requestAnimationFrame(update);\r\n    });\r\n})();\r\n"],"file":"script.babel.js"}