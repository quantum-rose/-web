{"version":3,"sources":["script.js"],"names":["$cvs","document","querySelector","$reset","cvsCtx","getContext","w","width","offsetWidth","window","devicePixelRatio","h","height","offsetHeight","offsetX","offsetY","mouseX","mouseY","zoom","lastPoint","x","y","addEventListener","bindWheelEvent","elem","callback","navigator","userAgent","toLowerCase","indexOf","wheel","e","preventDefault","dir","detail","wheelDelta","grabbing","removeEvent","removeEventListener","grab","arc","parametric","t","cx","cy","r","Math","cos","sin","arc_0_0_100","ellipse","rx","ry","parabola","p","helical","l","star","quadricBezier","p0","p1","p2","cubicBezier","p3","requestAnimationFrame","render","clearRect","save","transform","per","Date","now","firstPer","min","secondPer","max","offset","PI","draw","lineWidth","strokeStyle","Vector2D","rotate","restore"],"mappings":"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","sourcesContent":["const $cvs = document.querySelector('#cvs');\r\nconst $reset = document.querySelector('.reset');\r\nconst cvsCtx = $cvs.getContext('2d');\r\nlet w = ($cvs.width = $cvs.offsetWidth * window.devicePixelRatio);\r\nlet h = ($cvs.height = $cvs.offsetHeight * window.devicePixelRatio);\r\nlet offsetX = w / 2; // 画布坐标原点的偏移，初始为画布大小的一半，使得原点位于屏幕中心\r\nlet offsetY = h / 2;\r\nlet mouseX = 0; // 鼠标相对于画布原点的坐标\r\nlet mouseY = 0;\r\nlet zoom = 1; // 画布缩放倍数\r\nlet lastPoint = {\r\n    x: 0,\r\n    y: 0,\r\n}; // 鼠标移动过程中上一个点的位置\r\n\r\n/**\r\n * 监听窗口大小的改变，动态修改canvas的大小\r\n */\r\nwindow.addEventListener('resize', function () {\r\n    w = $cvs.width = $cvs.offsetWidth * window.devicePixelRatio;\r\n    h = $cvs.height = $cvs.offsetHeight * window.devicePixelRatio;\r\n    offsetX = w / 2;\r\n    offsetY = h / 2;\r\n});\r\n\r\n/**\r\n * 绑定滚轮事件，处理兼容性问题\r\n * @param {Element} elem\r\n * @param {Function} callback\r\n */\r\nfunction bindWheelEvent(elem, callback) {\r\n    if (window.navigator.userAgent.toLowerCase().indexOf('firefox') != -1) {\r\n        elem.addEventListener('DOMMouseScroll', wheel, false);\r\n    } else {\r\n        elem.addEventListener('mousewheel', wheel, false);\r\n    }\r\n    function wheel(e) {\r\n        e.preventDefault();\r\n        const dir = e.detail ? e.detail > 0 : e.wheelDelta < 0;\r\n        callback(e, dir);\r\n    }\r\n}\r\n\r\n/**\r\n * 根据滚轮滚动方向缩放画布，并且是以鼠标所在位置为中心进行缩放\r\n */\r\nbindWheelEvent($cvs, function (e, dir) {\r\n    mouseX = e.offsetX - offsetX;\r\n    mouseY = offsetY - e.offsetY;\r\n\r\n    /**\r\n     * 设鼠标当前相对画布原点的坐标为 a(x, y)\r\n     * 则画布缩放n倍后的坐标为 b(nx, ny)\r\n     * 缩放后的水平偏移为 (n-1)x，竖直偏移为 (n-1)y\r\n     * 将画布平移相同的距离，即可在视觉效果上实现以鼠标为中心的缩放\r\n     * 因为在这个例子中，我将画布的纵轴上下翻转了\r\n     * 所以 (n-1)y 小于0时平移的方向是向下的\r\n     * 但画布的平移变换大于0才是向下的，两者的符号相反\r\n     */\r\n    if (dir && zoom > 0.1) {\r\n        zoom *= 0.8;\r\n        offsetX += mouseX * 0.2;\r\n        offsetY -= mouseY * 0.2;\r\n    }\r\n\r\n    if (!dir && zoom < 100) {\r\n        zoom *= 1.25;\r\n        offsetX -= mouseX * 0.25;\r\n        offsetY += mouseY * 0.25;\r\n    }\r\n});\r\n\r\nfunction grabbing(e) {\r\n    const { offsetX: x, offsetY: y } = e;\r\n    offsetX += x - lastPoint.x;\r\n    offsetY += y - lastPoint.y;\r\n    lastPoint.x = x;\r\n    lastPoint.y = y;\r\n}\r\nfunction removeEvent() {\r\n    $cvs.removeEventListener('mousemove', grabbing);\r\n    $cvs.removeEventListener('mouseleave', removeEvent);\r\n}\r\nfunction grab(e) {\r\n    lastPoint.x = e.offsetX;\r\n    lastPoint.y = e.offsetY;\r\n    $cvs.addEventListener('mousemove', grabbing);\r\n    $cvs.addEventListener('mouseleave', removeEvent);\r\n}\r\n$cvs.addEventListener('mousedown', grab);\r\n$cvs.addEventListener('mouseup', removeEvent);\r\n\r\n$reset.addEventListener('click', function () {\r\n    offsetX = w / 2;\r\n    offsetY = h / 2;\r\n    zoom = 1;\r\n});\r\n\r\n/**\r\n * 圆\r\n */\r\nconst arc = parametric((t, cx, cy, r) => [cx + r * Math.cos(t), cy + r * Math.sin(t)]);\r\n\r\n/**\r\n * 圆心(0,0)半径100的圆\r\n */\r\nconst arc_0_0_100 = parametric(t => [100 * Math.cos(t), 100 * Math.sin(t)]);\r\n\r\n/**\r\n * 椭圆\r\n */\r\nconst ellipse = parametric((t, cx, cy, rx, ry) => [cx + rx * Math.cos(t), cy + ry * Math.sin(t)]);\r\n\r\n/**\r\n * 抛物线\r\n */\r\nconst parabola = parametric((t, x, y, p) => [x + 2 * p * t, y + 2 * p * t ** 2]);\r\n\r\n/**\r\n * 阿基米德螺线\r\n */\r\nconst helical = parametric((t, l) => [l * t * Math.cos(t), l * t * Math.sin(t)]);\r\n\r\n/**\r\n * 四角星\r\n */\r\nconst star = parametric((t, l) => [l * Math.cos(t) ** 3, l * Math.sin(t) ** 3]);\r\n\r\n/**\r\n * 二次贝塞尔曲线\r\n */\r\nconst quadricBezier = parametric((t, p0, p1, p2) => [\r\n    (1 - t) ** 2 * p0.x + 2 * (1 - t) * t * p1.x + t ** 2 * p2.x,\r\n    (1 - t) ** 2 * p0.y + 2 * (1 - t) * t * p1.y + t ** 2 * p2.y,\r\n]);\r\n\r\n/**\r\n * 三次贝塞尔曲线\r\n */\r\nconst cubicBezier = parametric((t, p0, p1, p2, p3) => [\r\n    (1 - t) ** 3 * p0.x + 3 * (1 - t) ** 2 * t * p1.x + 3 * (1 - t) * t ** 2 * p2.x + t ** 3 * p3.x,\r\n    (1 - t) ** 3 * p0.y + 3 * (1 - t) ** 2 * t * p1.y + 3 * (1 - t) * t ** 2 * p2.y + t ** 3 * p3.y,\r\n]);\r\n\r\nrequestAnimationFrame(function render() {\r\n    cvsCtx.clearRect(0, 0, w, h);\r\n    cvsCtx.save();\r\n    cvsCtx.transform(zoom, 0, 0, -zoom, offsetX, offsetY);\r\n\r\n    const per = (Date.now() % 2500) / 2500;\r\n    const firstPer = Math.min(per / 0.5, 1);\r\n    const secondPer = Math.max((per - 0.5) / 0.5, 0);\r\n    const offset = Math.PI * 2 * ((Date.now() % 3000) / 3000);\r\n\r\n    arc(0, Math.PI * 2, 60, -800, 800, 200).draw(cvsCtx);\r\n    arc(secondPer * Math.PI * 2 + offset, firstPer * Math.PI * 2 + offset, 60, 800, 800, 200).draw(cvsCtx, {\r\n        lineWidth: 30,\r\n        strokeStyle: '#007bff',\r\n    });\r\n\r\n    arc_0_0_100(0, Math.PI * 2).draw(cvsCtx);\r\n\r\n    ellipse(0, Math.PI * 2, 60, -800, -800, 300, 200).draw(cvsCtx);\r\n    ellipse(secondPer * Math.PI * 2 + offset, firstPer * Math.PI * 2 + offset, 60, 800, -800, 300, 50).draw(cvsCtx);\r\n\r\n    parabola(-10, 10, 800, 0, 0, 100).draw(cvsCtx);\r\n\r\n    helical(0, 50, 800, 10).draw(cvsCtx, { strokeStyle: 'red' });\r\n\r\n    star(0, Math.PI * 2, 100, 400).draw(cvsCtx, { strokeStyle: 'blue' });\r\n\r\n    {\r\n        const p0 = new Vector2D(-1200, 0);\r\n        const p1 = new Vector2D(-800, 0);\r\n        p1.rotate(Math.PI / 4);\r\n        const p2 = new Vector2D(-750, 0);\r\n        quadricBezier(0, 1, 100, p0, p1, p2).draw(cvsCtx);\r\n    }\r\n\r\n    {\r\n        const p0 = new Vector2D(600, 0);\r\n        const p1 = new Vector2D(1100, 0);\r\n        p1.rotate(Math.PI / -4);\r\n        const p2 = new Vector2D(1200, 0);\r\n        p2.rotate(Math.PI / 4);\r\n        const p3 = new Vector2D(1250, 0);\r\n        cubicBezier(0, 1, 100, p0, p1, p2, p3).draw(cvsCtx);\r\n    }\r\n\r\n    cvsCtx.restore();\r\n\r\n    requestAnimationFrame(render);\r\n});\r\n"],"file":"script.babel.js"}