{"version":3,"sources":["script.js"],"names":["$cvs","document","querySelector","$reset","cvsCtx","getContext","w","width","offsetWidth","window","devicePixelRatio","h","height","offsetHeight","offsetX","offsetY","mouseX","mouseY","zoom","lastPoint","x","y","addEventListener","bindWheelEvent","elem","callback","navigator","userAgent","toLowerCase","indexOf","wheel","e","preventDefault","dir","detail","wheelDelta","grabbing","removeEvent","removeEventListener","grab","arc","parametric","t","cx","cy","r","Math","cos","sin","arc_0_0_100","ellipse","rx","ry","parabola","p","helical","l","star","quadricBezier","p0","p1","p2","cubicBezier","p3","requestAnimationFrame","render","clearRect","save","transform","per","Date","now","firstPer","min","secondPer","max","offset","PI","draw","lineWidth","strokeStyle","Vector2D","rotate","restore"],"mappings":"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","sourcesContent":["const $cvs = document.querySelector('#cvs');\r\nconst $reset = document.querySelector('.reset');\r\nconst cvsCtx = $cvs.getContext('2d');\r\nlet w = ($cvs.width = $cvs.offsetWidth * window.devicePixelRatio);\r\nlet h = ($cvs.height = $cvs.offsetHeight * window.devicePixelRatio);\r\nlet offsetX = w / 2; // 画布坐标原点的偏移，初始为画布大小的一半，使得原点位于屏幕中心\r\nlet offsetY = h / 2;\r\nlet mouseX = 0; // 鼠标相对于画布原点的坐标\r\nlet mouseY = 0;\r\nlet zoom = 1; // 画布缩放倍数\r\nlet lastPoint = {\r\n    x: 0,\r\n    y: 0,\r\n}; // 鼠标移动过程中上一个点的位置\r\n\r\n/**\r\n * 监听窗口大小的改变，动态修改canvas的大小\r\n */\r\nwindow.addEventListener('resize', function () {\r\n    w = $cvs.width = $cvs.offsetWidth * window.devicePixelRatio;\r\n    h = $cvs.height = $cvs.offsetHeight * window.devicePixelRatio;\r\n    offsetX = w / 2;\r\n    offsetY = h / 2;\r\n});\r\n\r\n/**\r\n * 绑定滚轮事件，处理兼容性问题\r\n * @param {Element} elem\r\n * @param {Function} callback\r\n */\r\nfunction bindWheelEvent(elem, callback) {\r\n    if (window.navigator.userAgent.toLowerCase().indexOf('firefox') != -1) {\r\n        elem.addEventListener('DOMMouseScroll', wheel, false);\r\n    } else {\r\n        elem.addEventListener('mousewheel', wheel, false);\r\n    }\r\n    function wheel(e) {\r\n        e.preventDefault();\r\n        const dir = e.detail ? e.detail > 0 : e.wheelDelta < 0;\r\n        callback(e, dir);\r\n    }\r\n}\r\n\r\n/**\r\n * 根据滚轮滚动方向缩放画布，并且是以鼠标所在位置为中心进行缩放\r\n */\r\nbindWheelEvent($cvs, function (e, dir) {\r\n    mouseX = e.offsetX - offsetX;\r\n    mouseY = offsetY - e.offsetY;\r\n\r\n    /**\r\n     * 设鼠标当前相对画布原点的坐标为 a(x, y)\r\n     * 则画布缩放n倍后的坐标为 b(nx, ny)\r\n     * 缩放后的水平偏移为 (n-1)x，竖直偏移为 (n-1)y\r\n     * 将画布平移相同的距离，即可在视觉效果上实现以鼠标为中心的缩放\r\n     * 因为在这个例子中，我将画布的纵轴上下翻转了\r\n     * 所以 (n-1)y 小于0时平移的方向是向下的\r\n     * 但画布的平移变换大于0才是向下的，两者的符号相反\r\n     */\r\n    if (dir && zoom > 0.1) {\r\n        zoom *= 0.8;\r\n        offsetX += mouseX * 0.2;\r\n        offsetY -= mouseY * 0.2;\r\n    }\r\n\r\n    if (!dir && zoom < 100) {\r\n        zoom *= 1.25;\r\n        offsetX -= mouseX * 0.25;\r\n        offsetY += mouseY * 0.25;\r\n    }\r\n});\r\n\r\nfunction grabbing(e) {\r\n    const { offsetX: x, offsetY: y } = e;\r\n    offsetX += x - lastPoint.x;\r\n    offsetY += y - lastPoint.y;\r\n    lastPoint.x = x;\r\n    lastPoint.y = y;\r\n}\r\nfunction removeEvent() {\r\n    $cvs.removeEventListener('mousemove', grabbing);\r\n    $cvs.removeEventListener('mouseleave', removeEvent);\r\n}\r\nfunction grab(e) {\r\n    lastPoint.x = e.offsetX;\r\n    lastPoint.y = e.offsetY;\r\n    $cvs.addEventListener('mousemove', grabbing);\r\n    $cvs.addEventListener('mouseleave', removeEvent);\r\n}\r\n$cvs.addEventListener('mousedown', grab);\r\n$cvs.addEventListener('mouseup', removeEvent);\r\n\r\n$reset.addEventListener('click', function () {\r\n    offsetX = w / 2;\r\n    offsetY = h / 2;\r\n    zoom = 1;\r\n});\r\n\r\n/**\r\n * 圆\r\n */\r\nconst arc = parametric((t, cx, cy, r) => [cx + r * Math.cos(t), cy + r * Math.sin(t)]);\r\n\r\n/**\r\n * 圆心(0,0)半径100的圆\r\n */\r\nconst arc_0_0_100 = parametric(t => [100 * Math.cos(t), 100 * Math.sin(t)]);\r\n\r\n/**\r\n * 椭圆\r\n */\r\nconst ellipse = parametric((t, cx, cy, rx, ry) => [cx + rx * Math.cos(t), cy + ry * Math.sin(t)]);\r\n\r\n/**\r\n * 抛物线\r\n */\r\nconst parabola = parametric((t, x, y, p) => [x + 2 * p * t, y + 2 * p * t ** 2]);\r\n\r\n/**\r\n * 阿基米德螺线\r\n */\r\nconst helical = parametric((t, l) => [l * t * Math.cos(t), l * t * Math.sin(t)]);\r\n\r\n/**\r\n * 四角星\r\n */\r\nconst star = parametric((t, l) => [l * Math.cos(t) ** 3, l * Math.sin(t) ** 3]);\r\n\r\n/**\r\n * 二次贝塞尔曲线\r\n */\r\nconst quadricBezier = parametric((t, p0, p1, p2) => [\r\n    (1 - t) ** 2 * p0.x + 2 * (1 - t) * t * p1.x + t ** 2 * p2.x,\r\n    (1 - t) ** 2 * p0.y + 2 * (1 - t) * t * p1.y + t ** 2 * p2.y,\r\n]);\r\n\r\n/**\r\n * 三次贝塞尔曲线\r\n */\r\nconst cubicBezier = parametric((t, p0, p1, p2, p3) => [\r\n    (1 - t) ** 3 * p0.x + 3 * (1 - t) ** 2 * t * p1.x + 3 * (1 - t) * t ** 2 * p2.x + t ** 3 * p3.x,\r\n    (1 - t) ** 3 * p0.y + 3 * (1 - t) ** 2 * t * p1.y + 3 * (1 - t) * t ** 2 * p2.y + t ** 3 * p3.y,\r\n]);\r\n\r\nrequestAnimationFrame(function render() {\r\n    cvsCtx.clearRect(0, 0, w, h);\r\n    cvsCtx.save();\r\n    cvsCtx.transform(zoom, 0, 0, -zoom, offsetX, offsetY);\r\n\r\n    const per = (Date.now() % 2500) / 2500;\r\n    const firstPer = Math.min(per / 0.5, 1);\r\n    const secondPer = Math.max((per - 0.5) / 0.5, 0);\r\n    const offset = Math.PI * 2 * ((Date.now() % 3000) / 3000);\r\n\r\n    arc(0, Math.PI * 2, 60, -800, 800, 200).draw(cvsCtx);\r\n    arc(secondPer * Math.PI * 2 + offset, firstPer * Math.PI * 2 + offset, 60, 800, 800, 200).draw(cvsCtx, {\r\n        lineWidth: 30,\r\n        strokeStyle: '#007bff',\r\n    });\r\n\r\n    arc_0_0_100(0, Math.PI * 2).draw(cvsCtx);\r\n\r\n    ellipse(0, Math.PI * 2, 60, -800, -800, 300, 200).draw(cvsCtx);\r\n    ellipse(secondPer * Math.PI * 2 + offset, firstPer * Math.PI * 2 + offset, 60, 800, -800, 300, 50).draw(cvsCtx);\r\n\r\n    parabola(-10, 10, 800, 0, 0, 100).draw(cvsCtx);\r\n\r\n    helical(0, 50, 800, 10).draw(cvsCtx, { strokeStyle: 'red' });\r\n\r\n    star(0, Math.PI * 2, 100, 400).draw(cvsCtx, { strokeStyle: 'blue' });\r\n\r\n    {\r\n        const p0 = new Vector2D(-1200, 0);\r\n        const p1 = new Vector2D(-800, 0);\r\n        p1.rotate(Math.PI / 4);\r\n        const p2 = new Vector2D(-750, 0);\r\n        quadricBezier(0, 1, 100, p0, p1, p2).draw(cvsCtx);\r\n    }\r\n\r\n    {\r\n        const p0 = new Vector2D(600, 0);\r\n        const p1 = new Vector2D(1100, 0);\r\n        p1.rotate(Math.PI / -4);\r\n        const p2 = new Vector2D(1200, 0);\r\n        p2.rotate(Math.PI / 4);\r\n        const p3 = new Vector2D(1250, 0);\r\n        cubicBezier(0, 1, 100, p0, p1, p2, p3).draw(cvsCtx);\r\n    }\r\n\r\n    cvsCtx.restore();\r\n\r\n    requestAnimationFrame(render);\r\n});\r\n"],"file":"script.babel.js"}